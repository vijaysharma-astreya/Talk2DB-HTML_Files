<!DOCTYPE html>
<!-- saved from url=(0035)http://127.0.0.1:5500/frontend.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>DB Assistant</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #eef1f5;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            justify-content: center;
            align-items: center;
        }

        .chat-container {
            width: 80%;
            height: 70%;
            background: #fff;
            border-radius: 14px;
            box-shadow: 0 4px 18px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            background: #4a77f7;
            padding: 16px;
            color: white;
            font-size: 18px;
            font-weight: bold;
        }

        .chat-box {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            background: #f7f9fc;
        }

        .msg {
            margin-bottom: 12px;
            padding: 10px 14px;
            border-radius: 12px;
            max-width: 80%;
            line-height: 1.4;
            font-size: 14px;
        }

        .user-msg {
            background: #4a77f7;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 2px;
        }

        .bot-msg {
            background: #e5e7eb;
            color: #111;
            align-self: flex-start;
            border-bottom-left-radius: 2px;
        }

        .chat-input-area {
            display: flex;
            border-top: 1px solid #ddd;
        }

        input {
            flex: 1;
            padding: 12px;
            border: none;
            outline: none;
            font-size: 15px;
        }

        button {
            padding: 0 18px;
            background: #4a77f7;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }

        button:hover {
            background: #3b63d6;
        }

        .request-block {
            margin-bottom: 20px;
        }
    </style>
</head>

<body>

    <div class="chat-container">
        <style>
            .chat-header {
                background-color: #4a77f7;
                color: #ffffff;
                padding: 12px 20px;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                font-size: 18px;
                border-radius: 8px;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                display: inline-block;
            }
            
            .chat-header .assistant-name {
                color: #f48a26; /* Highlight color for DB Assistant */
                font-weight: bold;
                font-size: 20px;
                margin-right: 6px;
            }
            </style>
            
            <div class="chat-header">
                <span class="assistant-name">DB Assistant</span> - Remember, even humans make mistakes !
            </div>
            

        <div class="chat-box" id="chatBox"><div class="request-block"><div class="msg user-msg">Give me number of all assests of Tom Andrews from fact assets</div><div class="msg bot-msg"><b>Agent Steps:</b><br><div>
                            <div><b>ðŸ”§ Step 1 â€” Calling tool: bigquery_list_tables</b></div>

                            <details>
                                <summary>ðŸ“¥ Tool Input</summary>
                                <pre>{}</pre>
                            </details>

                            <div id="tool-output-dfb462899e524ea79d42d2d0437216ac">
                                <details>
                                    <summary>ðŸ“„ Tool Output</summary>
                                    <pre>agent_insights: No description available.
available_columns: No description available.
catalog: No description available.
data_dictionary: No description available.
dim_employees: No description available.
dlp_findings: No description available.
dlp_summary: PII (Personally Identifiable Information) detection summary table aggregating Google Cloud DLP scan results across all datasets.Identifies sensitive data elements, their locations, severity levels, and occurrence patterns to support data privacy compliance (GDPR, CCPA, HIPAA), data minimization strategies, and security risk assessments.This table powers privacy impact assessments, data classification workflows, and sensitive data inventory reporting.
dlpwork: No description available.
fact_assets: No description available.
insight_computation: No description available.
insights: Actionable business insights and analytical queries catalog that identifies which pre-built insights   can be executed against available datasets. This table serves as the bridge between the insight library (potential analyses) and   actual data availability, filtering out insights that cannot be run due to missing columns or tables.   Powers insight recommendation engines, automated analytics generation, data discovery workflows, and   helps data consumers understand what questions can be answered with existing data. Essential for self-service analytics enablement and maximizing value extraction from curated datasets.
insights_computation: No description available.
intune_assets: Intune Asset Inventory snapshot of devices managed via MDM. 
itglue_assets: IT Glue Asset Inventory snapshot of Apple devices (macOS, iOS/iPadOS, tvOS) managed via MDM. 
itglue_consumables: Inventory of IT Glue consumables (e.g., toner, cables, peripherals) with vendor/PO details, cost/quantity.
metadata_summary: Comprehensive metadata summary table combining insights, data quality metrics, profiling statistics, and table characteristics across all datasets
missed_insights: Data gap analysis table identifying insights that cannot be executed due to missing columns or tables in the current data warehouse. This table serves as a strategic roadmap for data acquisition and schema enhancement by quantifying the analytical value locked behind missing data elements. Powers prioritization decisions for data pipeline development, guides vendor API integration scoping, supports business cases for new data sources, and enables product managers to communicate the incremental value of data investments. Critical for data strategy planning and maximizing ROI on data engineering efforts.
mosyle_assets: Mosyle Asset Inventory snapshot of Apple devices (macOS, iOS/iPadOS, tvOS) managed via MDM.
profiling: No description available.
profiling_summary: Statistical data profiling summary table that provides comprehensive column-level insights across all datasets. Aggregates metrics on data distribution, cardinality, null prevalence, and value patterns to support data quality assessment,schema optimization, data modeling decisions, and anomaly detection. This table enables data engineers to understand data characteristics, identify optimization opportunities, and validate data transformation logic.
quality: No description available.
quality_summary: Comprehensive data quality monitoring table that aggregates Dataquality scan results across all data sources. Provides dimension-level quality scores, alert counts, and distribution metrics to enable proactive data quality management and identify datasets requiring remediation. This table powers quality dashboards, SLA monitoring, and data governance reporting.
workday_employees: Employee snapshot dataset, one row per employee.</pre>
                                </details>
                            </div>
                        </div><div>
                            <div><b>ðŸ”§ Step 2 â€” Calling tool: bigquery_get_schema</b></div>

                            <details>
                                <summary>ðŸ“¥ Tool Input</summary>
                                <pre>{
  "table_names": [
    "fact_assets"
  ]
}</pre>
                            </details>

                            <div id="tool-output-3abd56831d1e4ab887bdf9a01ae7af70">
                                <details>
                                    <summary>ðŸ“„ Tool Output</summary>
                                    <pre>
Table: fact_assets
Schema:
asset_id (STRING) - No description available.
asset_name (STRING) - No description available.
asset_description (STRING) - No description available.
asset_type (STRING) - No description available.
client_asset_id (STRING) - No description available.
serial_number (STRING) - No description available.
status (STRING) - No description available.
ownership (STRING) - No description available.
model_name (STRING) - No description available.
cpu (STRING) - No description available.
memory_gb (FLOAT) - No description available.
storage_total_gb (FLOAT) - No description available.
mac_address (STRING) - No description available.
purchase_order (STRING) - No description available.
purchase_price (FLOAT) - No description available.
currency (STRING) - No description available.
warranty_end_date (DATE) - No description available.
decommission_date (DATE) - No description available.
is_active (BOOLEAN) - No description available.
archived (BOOLEAN) - No description available.
user_id (STRING) - No description available.
location_id (STRING) - No description available.
country (STRING) - No description available.
excluded_from_audit_scope (BOOLEAN) - No description available.
notes (STRING) - No description available.
updated_at (TIMESTAMP) - No description available.
category (STRING) - No description available.
unit_cost (FLOAT) - No description available.
ship_to_via (STRING) - No description available.
ship_to_tracking (STRING) - No description available.
asset_url (STRING) - No description available.
ticket_url (STRING) - No description available.
quantity_requested (INTEGER) - No description available.
user_name (STRING) - No description available.
in_service_date (DATE) - No description available.
expected_return_date (DATE) - No description available.
ingestion_date (DATE) - No description available.
ingestion_timestamp (TIMESTAMP) - No description available.
raw_input_filename (STRING) - No description available.
curated_input_filename (STRING) - No description available.
data_source (STRING) - No description available.

Sample Rows:
[{'asset_id': 'b9c6ee89-f8a0-4d8d-ae58-af72b5f93c0d', 'asset_name': '0F00B58214000C', 'asset_description': None, 'asset_type': None, 'client_asset_id': None, 'serial_number': '0F00B58214000C', 'status': None, 'ownership': 'Corporate', 'model_name': None, 'cpu': None, 'memory_gb': None, 'storage_total_gb': 975574.0, 'mac_address': None, 'purchase_order': None, 'purchase_price': None, 'currency': None, 'warranty_end_date': None, 'decommission_date': None, 'is_active': None, 'archived': None, 'user_id': 'f7371a06-0c3e-4e8e-8627-dba5197206a6', 'location_id': None, 'country': None, 'excluded_from_audit_scope': None, 'notes': None, 'updated_at': None, 'category': None, 'unit_cost': None, 'ship_to_via': None, 'ship_to_tracking': None, 'asset_url': None, 'ticket_url': None, 'quantity_requested': None, 'user_name': 'David Burton', 'in_service_date': None, 'expected_return_date': None, 'ingestion_date': datetime.date(2025, 10, 24), 'ingestion_timestamp': datetime.datetime(2025, 10, 24, 10, 58, 48, 336203, tzinfo=datetime.timezone.utc), 'raw_input_filename': 'gs://ipd-dev-raw/astreya/intune/assets/date=20251024/intune_assets.csv', 'curated_input_filename': 'gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251024/part-00000-1f0810cf-1116-4e12-bde3-1094a1a92b07.c000.snappy.parquet', 'data_source': 'intune_assets'}, {'asset_id': 'b9c6ee89-f8a0-4d8d-ae58-af72b5f93c0d', 'asset_name': '0F00B58214000C', 'asset_description': None, 'asset_type': None, 'client_asset_id': None, 'serial_number': '0F00B58214000C', 'status': None, 'ownership': 'Corporate', 'model_name': None, 'cpu': None, 'memory_gb': None, 'storage_total_gb': 975574.0, 'mac_address': None, 'purchase_order': None, 'purchase_price': None, 'currency': None, 'warranty_end_date': None, 'decommission_date': None, 'is_active': None, 'archived': None, 'user_id': 'f7371a06-0c3e-4e8e-8627-dba5197206a6', 'location_id': None, 'country': None, 'excluded_from_audit_scope': None, 'notes': None, 'updated_at': None, 'category': None, 'unit_cost': None, 'ship_to_via': None, 'ship_to_tracking': None, 'asset_url': None, 'ticket_url': None, 'quantity_requested': None, 'user_name': 'David Burton', 'in_service_date': None, 'expected_return_date': None, 'ingestion_date': datetime.date(2025, 10, 24), 'ingestion_timestamp': datetime.datetime(2025, 10, 24, 10, 58, 48, 336203, tzinfo=datetime.timezone.utc), 'raw_input_filename': 'gs://ipd-dev-raw/astreya/intune/assets/date=20251024/intune_assets1.csv', 'curated_input_filename': 'gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251024/part-00001-1f0810cf-1116-4e12-bde3-1094a1a92b07.c000.snappy.parquet', 'data_source': 'intune_assets'}, {'asset_id': '4f2ce9f7-1ba7-404a-a5cf-b9e736eb7c28', 'asset_name': '0F33VFD24033GT', 'asset_description': None, 'asset_type': None, 'client_asset_id': None, 'serial_number': '0F33VFD24033GT', 'status': None, 'ownership': 'Corporate', 'model_name': None, 'cpu': None, 'memory_gb': None, 'storage_total_gb': 241873.0, 'mac_address': None, 'purchase_order': None, 'purchase_price': None, 'currency': None, 'warranty_end_date': None, 'decommission_date': None, 'is_active': None, 'archived': None, 'user_id': '82ee6a72-eb48-41d7-b991-9a2a3f9d0c84', 'location_id': None, 'country': None, 'excluded_from_audit_scope': None, 'notes': None, 'updated_at': None, 'category': None, 'unit_cost': None, 'ship_to_via': None, 'ship_to_tracking': None, 'asset_url': None, 'ticket_url': None, 'quantity_requested': None, 'user_name': 'Romil Bahl', 'in_service_date': None, 'expected_return_date': None, 'ingestion_date': datetime.date(2025, 10, 24), 'ingestion_timestamp': datetime.datetime(2025, 10, 24, 10, 58, 48, 336203, tzinfo=datetime.timezone.utc), 'raw_input_filename': 'gs://ipd-dev-raw/astreya/intune/assets/date=20251024/intune_assets1.csv', 'curated_input_filename': 'gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251024/part-00001-1f0810cf-1116-4e12-bde3-1094a1a92b07.c000.snappy.parquet', 'data_source': 'intune_assets'}]</pre>
                                </details>
                            </div>
                        </div><div>
                            <div><b>ðŸ”§ Step 3 â€” Calling tool: bq_unified_query_checker</b></div>

                            <details>
                                <summary>ðŸ“¥ Tool Input</summary>
                                <pre>{
  "query": "SELECT count(asset_id) FROM `fact_assets` WHERE user_name = 'Tom Andrews'"
}</pre>
                            </details>

                            <div id="tool-output-81c0782287f84f24acd93f2d4cc4fd32">
                                <details>
                                    <summary>ðŸ“„ Tool Output</summary>
                                    <pre>{"final_status": "PASS", "message": "Query validated and safe to execute", "corrected_sql": "SELECT count(asset_id) FROM `fact_assets` WHERE user_name = 'Tom Andrews'", "layers": {"llm_checker": {"status": "PASS", "detail": "LLM returned candidate SQL", "output": "SELECT count(asset_id) FROM `fact_assets` WHERE user_name = 'Tom Andrews'"}, "static_checker": {"status": "PASS", "detail": "No modification detected", "output": "SELECT count(asset_id) FROM `fact_assets` WHERE user_name = 'Tom Andrews'"}, "dry_run": {"status": "PASS", "detail": "Dry run succeeded", "output": "DRY_RUN_OK"}}}</pre>
                                </details>
                            </div>
                        </div><div>
                            <div><b>ðŸ”§ Step 4 â€” Calling tool: bigquery_query</b></div>

                            <details>
                                <summary>ðŸ“¥ Tool Input</summary>
                                <pre>{
  "query": "SELECT count(asset_id) FROM `fact_assets` WHERE user_name = 'Tom Andrews'"
}</pre>
                            </details>

                            <div id="tool-output-a0fa810b34014712be4207fb716d9437">
                                <details>
                                    <summary>ðŸ“„ Tool Output</summary>
                                    <pre>{
  "status": "SUCCESS",
  "executed_sql": "SELECT count(asset_id) FROM `fact_assets` WHERE user_name = 'Tom Andrews'",
  "rows": [
    {
      "f0_": 26
    }
  ],
  "row_count": 1
}</pre>
                                </details>
                            </div>
                        </div></div><div class="msg bot-msg"><iframe style="width: 100%; height: 500px; border: none;" src="./RepeatedData/saved_resource.html"></iframe></div></div><div class="request-block"><div class="msg user-msg">list down all of these</div><div class="msg bot-msg"><b>Agent Steps:</b><br><div>
                            <div><b>ðŸ”§ Step 1 â€” Calling tool: bq_unified_query_checker</b></div>

                            <details>
                                <summary>ðŸ“¥ Tool Input</summary>
                                <pre>{
  "query": "SELECT * FROM `fact_assets` WHERE user_name = 'Tom Andrews'"
}</pre>
                            </details>

                            <div id="tool-output-90f0c6778c39457da8ed0844ca6d2393">
                                <details>
                                    <summary>ðŸ“„ Tool Output</summary>
                                    <pre>{"final_status": "PASS", "message": "Query validated and safe to execute", "corrected_sql": "SELECT * FROM `fact_assets` WHERE user_name = 'Tom Andrews'", "layers": {"llm_checker": {"status": "PASS", "detail": "LLM returned candidate SQL", "output": "SELECT * FROM `fact_assets` WHERE user_name = 'Tom Andrews'"}, "static_checker": {"status": "PASS", "detail": "No modification detected", "output": "SELECT * FROM `fact_assets` WHERE user_name = 'Tom Andrews'"}, "dry_run": {"status": "PASS", "detail": "Dry run succeeded", "output": "DRY_RUN_OK"}}}</pre>
                                </details>
                            </div>
                        </div><div>
                            <div><b>ðŸ”§ Step 2 â€” Calling tool: bigquery_query</b></div>

                            <details>
                                <summary>ðŸ“¥ Tool Input</summary>
                                <pre>{
  "query": "SELECT * FROM `fact_assets` WHERE user_name = 'Tom Andrews'"
}</pre>
                            </details>

                            <div id="tool-output-40af45760bb144bfbc9fad723b751bf6">
                                <details>
                                    <summary>ðŸ“„ Tool Output</summary>
                                    <pre>{
  "status": "SUCCESS",
  "executed_sql": "SELECT * FROM `fact_assets` WHERE user_name = 'Tom Andrews'",
  "rows": [
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-24",
      "ingestion_timestamp": "2025-10-24T10:58:48.336203+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251024/intune_assets.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251024/part-00000-1f0810cf-1116-4e12-bde3-1094a1a92b07.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-24",
      "ingestion_timestamp": "2025-10-24T10:58:48.336203+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251024/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251024/part-00001-1f0810cf-1116-4e12-bde3-1094a1a92b07.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-28",
      "ingestion_timestamp": "2025-10-28T05:11:26.771565+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251027/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251027/part-00000-e882b1d5-f582-4001-82de-1158236d794f.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-28",
      "ingestion_timestamp": "2025-10-28T05:11:26.771565+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251028/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251028/part-00000-73bf3d15-685b-4619-b633-50b316b2f5b4.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-28",
      "ingestion_timestamp": "2025-10-28T11:29:12.971236+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251028/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251028/part-00000-73bf3d15-685b-4619-b633-50b316b2f5b4.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-28",
      "ingestion_timestamp": "2025-10-28T11:29:12.971236+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251027/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251027/part-00000-e882b1d5-f582-4001-82de-1158236d794f.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-28",
      "ingestion_timestamp": "2025-10-28T11:29:12.971236+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251028/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251028/part-00000-6a3e172f-65c3-4005-8c1d-272ea4df3082.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-29",
      "ingestion_timestamp": "2025-10-29T09:19:38.739761+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251027/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251027/part-00000-e882b1d5-f582-4001-82de-1158236d794f.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-29",
      "ingestion_timestamp": "2025-10-29T09:19:38.739761+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251028/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251028/part-00000-6a3e172f-65c3-4005-8c1d-272ea4df3082.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-29",
      "ingestion_timestamp": "2025-10-29T09:19:38.739761+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251028/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251028/part-00000-73bf3d15-685b-4619-b633-50b316b2f5b4.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-29",
      "ingestion_timestamp": "2025-10-29T09:19:38.739761+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251029/intune_assets.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251029/part-00000-441a8319-0d38-4665-89c1-d6881abbd2d0.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "86744275",
      "asset_name": "86744275",
      "asset_description": "Lenovo Thinkpad Wireless Mouse",
      "asset_type": "Consumable",
      "client_asset_id": null,
      "serial_number": null,
      "status": null,
      "ownership": null,
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": null,
      "mac_address": null,
      "purchase_order": "ITZ00078186",
      "purchase_price": null,
      "currency": "INR",
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": false,
      "user_id": null,
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": "2024-08-29T21:24:04+00:00",
      "category": "Mouse",
      "unit_cost": 790.0,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": "https://support.astreya.com/staff/ticket/77430",
      "quantity_requested": 1,
      "user_name": "Tom Andrews",
      "in_service_date": "2024-08-19",
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T07:50:39.641106+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/itglue/consumables/date=20251030/itglue_consumables_copyyyyyy.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/itglue/consumables/ingestion_date=20251030/part-00000-8550a12d-4893-4497-b3b3-4351f96aa67d.c000.snappy.parquet",
      "data_source": "itglue_consumables"
    },
    {
      "asset_id": "86744347",
      "asset_name": "86744347",
      "asset_description": "Lenovo 300 FHD Webcam",
      "asset_type": "Consumable",
      "client_asset_id": null,
      "serial_number": null,
      "status": null,
      "ownership": null,
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": null,
      "mac_address": null,
      "purchase_order": "ITZ00078186",
      "purchase_price": null,
      "currency": "INR",
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": false,
      "user_id": null,
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": "2024-08-29T21:26:55+00:00",
      "category": "Webcam",
      "unit_cost": 1790.0,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": "https://support.astreya.com/staff/ticket/77430",
      "quantity_requested": 1,
      "user_name": "Tom Andrews",
      "in_service_date": "2024-08-19",
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T07:50:39.641106+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/itglue/consumables/date=20251030/itglue_consumables_copyyyyyy.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/itglue/consumables/ingestion_date=20251030/part-00000-8550a12d-4893-4497-b3b3-4351f96aa67d.c000.snappy.parquet",
      "data_source": "itglue_consumables"
    },
    {
      "asset_id": "86744451",
      "asset_name": "86744451",
      "asset_description": "Lenovo USB-A Wired Stereo On-Ear headset",
      "asset_type": "Consumable",
      "client_asset_id": null,
      "serial_number": null,
      "status": null,
      "ownership": null,
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": null,
      "mac_address": null,
      "purchase_order": "ITZ00078186",
      "purchase_price": null,
      "currency": "INR",
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": false,
      "user_id": null,
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": "2024-08-29T21:28:32+00:00",
      "category": "Headset",
      "unit_cost": 2740.0,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": "https://support.astreya.com/staff/ticket/77430",
      "quantity_requested": 1,
      "user_name": "Tom Andrews",
      "in_service_date": "2024-08-19",
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T07:50:39.641106+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/itglue/consumables/date=20251030/itglue_consumables_copyyyyyy.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/itglue/consumables/ingestion_date=20251030/part-00000-8550a12d-4893-4497-b3b3-4351f96aa67d.c000.snappy.parquet",
      "data_source": "itglue_consumables"
    },
    {
      "asset_id": "86744553",
      "asset_name": "86744553",
      "asset_description": "Lenovo 65W Standard AC Adapter",
      "asset_type": "Consumable",
      "client_asset_id": null,
      "serial_number": null,
      "status": null,
      "ownership": null,
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": null,
      "mac_address": null,
      "purchase_order": "ITZ00078186",
      "purchase_price": null,
      "currency": "INR",
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": false,
      "user_id": null,
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": "2024-08-29T21:29:49+00:00",
      "category": "AC adapter",
      "unit_cost": 1105.0,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": "https://support.astreya.com/staff/ticket/77430",
      "quantity_requested": 1,
      "user_name": "Tom Andrews",
      "in_service_date": "2024-08-19",
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T07:50:39.641106+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/itglue/consumables/date=20251030/itglue_consumables_copyyyyyy.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/itglue/consumables/ingestion_date=20251030/part-00000-8550a12d-4893-4497-b3b3-4351f96aa67d.c000.snappy.parquet",
      "data_source": "itglue_consumables"
    },
    {
      "asset_id": "91947238",
      "asset_name": "91947238",
      "asset_description": "Apple Pencil Pro",
      "asset_type": "Asset part",
      "client_asset_id": null,
      "serial_number": null,
      "status": null,
      "ownership": null,
      "model_name": "Apple iPad Pro 13 WiFi + Cellular 1TB with Nano-texture Glass  Type",
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": null,
      "mac_address": null,
      "purchase_order": "AAA3125359",
      "purchase_price": null,
      "currency": "USD",
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": false,
      "user_id": null,
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": "2024-12-17T16:18:45+00:00",
      "category": "Mouse",
      "unit_cost": 129.0,
      "ship_to_via": "UPS",
      "ship_to_tracking": "1ZA828Y90163044979  &amp; 1ZA828Y90163044979",
      "asset_url": "https://www.apple.com/shop/product/MX2D3AM/A/apple-pencil-pro?fnode=c9c251f5423dfd3255cf4c2ab0bc0e9b78b9f3103f6c1efceeba335cfbf8b290126b2632dbff4b2617d3b46ebe5734234ac28004b71a698b963d1d658137eea39834613f2b8bfdc636b967cf9330e738f31c73a5f3dd34c9dbabbc8bf30",
      "ticket_url": "https://support.astreya.com/staff/ticket/86561/",
      "quantity_requested": 1,
      "user_name": "Tom Andrews",
      "in_service_date": "2024-12-06",
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T07:50:39.641106+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/itglue/consumables/date=20251030/itglue_consumables_copyyyyyy.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/itglue/consumables/ingestion_date=20251030/part-00000-8550a12d-4893-4497-b3b3-4351f96aa67d.c000.snappy.parquet",
      "data_source": "itglue_consumables"
    },
    {
      "asset_id": "91947284",
      "asset_name": "91947284",
      "asset_description": "Magic Keyboard for iPad Pro 13\u00e2\u20ac\u2018inch (M4)",
      "asset_type": "Asset part",
      "client_asset_id": null,
      "serial_number": null,
      "status": null,
      "ownership": null,
      "model_name": "Apple iPad Pro 13 WiFi + Cellular 1TB with Nano-texture Glass  Type",
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": null,
      "mac_address": null,
      "purchase_order": "AAA3125359",
      "purchase_price": null,
      "currency": "USD",
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": false,
      "user_id": null,
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": "2024-12-17T16:19:08+00:00",
      "category": "Keyboard",
      "unit_cost": 349.0,
      "ship_to_via": "UPS",
      "ship_to_tracking": "1ZA828Y90163044979  &amp; 1ZA828Y90163044979",
      "asset_url": "https://www.apple.com/shop/product/MWR43LL/A/magic-keyboard-for-ipad-pro-13%E2%80%91inch-m4-us-english-white?fnode=50de52eabc61124d25d3c611a73c099e4556c7ebee8704cbebb0f1b830481e9a1b8faeafaa9ebac90cabf9c051f59be61e5175fc0d762b05b03d575d2d4ef86ec954245dede3",
      "ticket_url": "https://support.astreya.com/staff/ticket/86561/",
      "quantity_requested": 1,
      "user_name": "Tom Andrews",
      "in_service_date": "2024-12-06",
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T07:50:39.641106+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/itglue/consumables/date=20251030/itglue_consumables_copyyyyyy.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/itglue/consumables/ingestion_date=20251030/part-00000-8550a12d-4893-4497-b3b3-4351f96aa67d.c000.snappy.parquet",
      "data_source": "itglue_consumables"
    },
    {
      "asset_id": "91947456",
      "asset_name": "91947456",
      "asset_description": "AirPods 4 with Active Noise Cancellation",
      "asset_type": "Asset part",
      "client_asset_id": null,
      "serial_number": null,
      "status": null,
      "ownership": null,
      "model_name": "Apple iPad Pro 13 WiFi + Cellular 1TB with Nano-texture Glass  Type",
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": null,
      "mac_address": null,
      "purchase_order": "AAA3125359",
      "purchase_price": null,
      "currency": "USD",
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": false,
      "user_id": null,
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": "SN:&nbsp;HXMXF2NFJK",
      "updated_at": "2024-12-17T16:24:27+00:00",
      "category": "Headset",
      "unit_cost": 179.0,
      "ship_to_via": "UPS",
      "ship_to_tracking": "1ZA828Y90163044979  &amp; 1ZA828Y90163044979",
      "asset_url": "https://www.apple.com/shop/buy-airpods/airpods-4?fnode=7e77c8104de2b3ff24ab132021ee931c8ad0e51a6f3b75d717444de47ec3397f8496a9c6e51acec5df539ed555fa3eaab5e8a6b3621b50d573aa01fb61eed7f254d55ad30bb7f06ebca54037c5aacf223ab5e6cc2a95a1583eca0d2133a4d75e",
      "ticket_url": "https://support.astreya.com/staff/ticket/86561/",
      "quantity_requested": 1,
      "user_name": "Tom Andrews",
      "in_service_date": "2024-12-06",
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T07:50:39.641106+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/itglue/consumables/date=20251030/itglue_consumables_copyyyyyy.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/itglue/consumables/ingestion_date=20251030/part-00000-8550a12d-4893-4497-b3b3-4351f96aa67d.c000.snappy.parquet",
      "data_source": "itglue_consumables"
    },
    {
      "asset_id": "91947501",
      "asset_name": "91947501",
      "asset_description": "Apple USB-C Digital AV Multiport Adapter",
      "asset_type": "Consumable",
      "client_asset_id": null,
      "serial_number": null,
      "status": null,
      "ownership": null,
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": null,
      "mac_address": null,
      "purchase_order": "AAA3125359",
      "purchase_price": null,
      "currency": "USD",
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": false,
      "user_id": null,
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": "2024-12-17T16:18:58+00:00",
      "category": "Cable",
      "unit_cost": 62.0,
      "ship_to_via": "UPS",
      "ship_to_tracking": "1ZA828Y90163044979  &amp; 1ZA828Y90163044979",
      "asset_url": "https://www.apple.com/shop/product/MW5M3AM/A/usb-c-digital-av-multiport-adapter?fnode=0e8c0f4cac3cb6f8b94bc273923cd7458c031e3a3f9d729a80c8eaffddd81e6f1b93bb3070e1798d5816b90e15f7315c83715e67f4225ff360c619890e47b35f98d2f2b202770d71ccf1a4d7956b87876637eca46",
      "ticket_url": "https://support.astreya.com/staff/ticket/86561/",
      "quantity_requested": 1,
      "user_name": "Tom Andrews",
      "in_service_date": "2024-12-06",
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T07:50:39.641106+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/itglue/consumables/date=20251030/itglue_consumables_copyyyyyy.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/itglue/consumables/ingestion_date=20251030/part-00000-8550a12d-4893-4497-b3b3-4351f96aa67d.c000.snappy.parquet",
      "data_source": "itglue_consumables"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T08:58:47.595669+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251028/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251028/part-00000-6a3e172f-65c3-4005-8c1d-272ea4df3082.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T08:58:47.595669+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251030/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251030/part-00000-ad88ca74-01b3-4d6e-b7cd-7b22a5ad2172.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T08:58:47.595669+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251029/intune_assets.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251029/part-00000-441a8319-0d38-4665-89c1-d6881abbd2d0.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T08:58:47.595669+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251029/intune_assets.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251029/part-00000-be03f375-ba37-4c19-b4fc-9821ccd34419.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T08:58:47.595669+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251027/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251027/part-00000-e882b1d5-f582-4001-82de-1158236d794f.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T08:58:47.595669+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251028/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251028/part-00000-73bf3d15-685b-4619-b633-50b316b2f5b4.c000.snappy.parquet",
      "data_source": "intune_assets"
    },
    {
      "asset_id": "7717ba91-b218-4d74-8326-8c7748390edc",
      "asset_name": "Jothi-Astreya",
      "asset_description": null,
      "asset_type": null,
      "client_asset_id": null,
      "serial_number": "PF4XBM5F",
      "status": null,
      "ownership": "Corporate",
      "model_name": null,
      "cpu": null,
      "memory_gb": null,
      "storage_total_gb": 974485.0,
      "mac_address": null,
      "purchase_order": null,
      "purchase_price": null,
      "currency": null,
      "warranty_end_date": null,
      "decommission_date": null,
      "is_active": null,
      "archived": null,
      "user_id": "fd816d2f-7cfd-463c-831e-3a36f404e5f5",
      "location_id": null,
      "country": null,
      "excluded_from_audit_scope": null,
      "notes": null,
      "updated_at": null,
      "category": null,
      "unit_cost": null,
      "ship_to_via": null,
      "ship_to_tracking": null,
      "asset_url": null,
      "ticket_url": null,
      "quantity_requested": null,
      "user_name": "Tom Andrews",
      "in_service_date": null,
      "expected_return_date": null,
      "ingestion_date": "2025-10-30",
      "ingestion_timestamp": "2025-10-30T08:58:47.595669+00:00",
      "raw_input_filename": "gs://ipd-dev-raw/astreya/intune/assets/date=20251030/intune_assets1.csv",
      "curated_input_filename": "gs://ipd-dev-curated/astreya/intune/assets/ingestion_date=20251030/part-00001-ce8b6012-f33f-49d0-959f-38ccae655527.c000.snappy.parquet",
      "data_source": "intune_assets"
    }
  ],
  "row_count": 26
}</pre>
                                </details>
                            </div>
                        </div></div><div class="msg bot-msg"><iframe style="width: 100%; height: 500px; border: none;" src="./Jothi-Assets_files/saved_resource(1).html"></iframe></div></div></div>

        <div class="chat-input-area">
            <input type="text" id="userInput" placeholder="Type your message...">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

    <script>
        // ðŸ”¥ NEW SESSION ID USING TIMESTAMP + HIGH PRECISION TIMER
        const sessionId = `${Date.now()}${performance.now().toFixed(3).replace('.', '')}`;
        console.log("Generated Session ID:", sessionId);

        // Maps step_id -> tool output div
        const stepOutputTargetMap = {};

        // Stores tool outputs that arrive early
        const pendingToolOutputs = {};

        async function sendMessage() {
            const input = document.getElementById("userInput");
            const chatBox = document.getElementById("chatBox");
            const text = input.value.trim();
            if (!text) return;

            input.value = "";

            // --- WRAPPER for this message ---
            const requestWrapper = document.createElement("div");
            requestWrapper.className = "request-block";
            chatBox.appendChild(requestWrapper);

            // USER MESSAGE
            const userBubble = document.createElement("div");
            userBubble.className = "msg user-msg";
            userBubble.innerText = text;
            requestWrapper.appendChild(userBubble);

            // Steps container for this request
            const stepsContainer = document.createElement("div");
            stepsContainer.className = "msg bot-msg";
            stepsContainer.innerHTML = "<b>Agent Steps:</b><br>";
            requestWrapper.appendChild(stepsContainer);

            chatBox.scrollTop = chatBox.scrollHeight;

            // --- Streaming fetch ---
            const response = await fetch(
                `http://localhost:8000/db_agent?user_input=${encodeURIComponent(text)}&session_id=${sessionId}`
            );

            const reader = response.body.getReader();
            const decoder = new TextDecoder();

            let finalAnswer = null;

            while (true) {
                const { value, done } = await reader.read();
                if (done) break;

                const chunk = decoder.decode(value, { stream: true });
                if (!chunk) continue;

                chunk.split("\n").forEach(line => {
                    if (!line.trim()) return;

                    let data;
                    try { data = JSON.parse(line); }
                    catch { return; }

                    // -------------------------------------------------------
                    // TOOL CALL
                    // -------------------------------------------------------
                    if (data.type === "tool_call") {
                        const stepId = data.step_id;
                        const uniqueDivId = `tool-output-${stepId}`;
                        stepOutputTargetMap[stepId] = uniqueDivId;

                        const box = document.createElement("div");
                        box.innerHTML = `
                            <div><b>ðŸ”§ Step ${data.sequence} â€” Calling tool: ${data.tool_name}</b></div>

                            <details>
                                <summary>ðŸ“¥ Tool Input</summary>
                                <pre>${JSON.stringify(data.tool_input, null, 2)}</pre>
                            </details>

                            <div id="${uniqueDivId}"></div>
                        `;

                        stepsContainer.appendChild(box);

                        // Apply pending tool output if it arrived early
                        if (pendingToolOutputs[stepId]) {
                            const outBox = document.getElementById(uniqueDivId);
                            outBox.innerHTML = `
                                <details>
                                    <summary>ðŸ“„ Tool Output</summary>
                                    <pre>${pendingToolOutputs[stepId]}</pre>
                                </details>
                            `;
                            delete pendingToolOutputs[stepId];
                        }
                    }

                    // -------------------------------------------------------
                    // TOOL OUTPUT
                    // -------------------------------------------------------
                    if (data.type === "tool_output") {
                        const stepId = data.step_id;
                        const divId = stepOutputTargetMap[stepId];
                        const outputDiv = divId ? document.getElementById(divId) : null;

                        if (outputDiv) {
                            outputDiv.innerHTML = `
                                <details>
                                    <summary>ðŸ“„ Tool Output</summary>
                                    <pre>${data.content}</pre>
                                </details>
                            `;
                        } else {
                            // output arrived before its tool_call
                            pendingToolOutputs[stepId] = data.content;
                        }
                    }

                    // -------------------------------------------------------
                    // FINAL AI MESSAGE
                    // -------------------------------------------------------
                    if (data.type === "ai_message") {
                        finalAnswer = data.content;
                    }

                    // -------------------------------------------------------
                    // ERROR
                    // -------------------------------------------------------
                    if (data.error) {
                        const errDiv = document.createElement("div");
                        errDiv.className = "msg bot-msg";
                        errDiv.style.color = "red";
                        errDiv.innerText = `Error: ${data.error}`;
                        requestWrapper.appendChild(errDiv);
                    }
                });

                chatBox.scrollTop = chatBox.scrollHeight;
            }

            // -------------------------------------------------------
            // RENDER FINAL ANSWER (inside THIS request block ONLY)
            // -------------------------------------------------------
            if (finalAnswer) {
            const finalDiv = document.createElement("div");
            finalDiv.className = "msg bot-msg";

            // Create iframe
            const iframe = document.createElement("iframe");
            iframe.style.width = "100%";
            iframe.style.height = "500px"; // adjust as needed
            iframe.style.border = "none";

            // Append iframe to finalDiv
            finalDiv.appendChild(iframe);   
            requestWrapper.appendChild(finalDiv);

            // Write the agent HTML into the iframe
            const doc = iframe.contentDocument || iframe.contentWindow.document;
            doc.open();
            doc.write(finalAnswer); // the full HTML/CSS/JS output
            doc.close();
        }

            chatBox.scrollTop = chatBox.scrollHeight;
        }
    </script>

<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>



</body></html>